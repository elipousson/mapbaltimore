<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light">
<script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/3/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>External, cached, and remote data sources • mapbaltimore</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/3/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/3/darkly/bootstrap.css" media="(prefers-color-scheme: dark)">
<!-- preferably CSS --><link rel="stylesheet" href="../preferably.css">
<link id="css-code-light" rel="stylesheet" href="../code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<link id="css-code-dark" rel="stylesheet" href="../code-color-scheme-dark.css" media="(prefers-color-scheme: dark)">
<!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="External, cached, and remote data sources">
<meta property="og:description" content="mapbaltimore">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mapbaltimore</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/extdata_cachedata.html">External, cached, and remote data sources</a>
    </li>
    <li>
      <a href="../articles/get_area.html">Get areas and data to layer on a map</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="extdata_cachedata_files/header-attrs-2.6.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>External, cached, and remote data sources</h1>
            
      
      
      <div class="hidden name"><code>extdata_cachedata.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Not all of the data for mapbaltimore is loaded when you first load the package. The reason is that large spatial data sets can take a long time to load and slow down your environment after they are loaded into active memory. GitHub also has a maximum file size of 100 megabytes. While some data sets are rarely updated, others are regularly updated—making the data included with this package potentially outdated.</p>
<p>mapbaltimore works around these issues in a few different ways:</p>
<ul>
<li>Storing large (&lt;100 MB) data sets as geopackage (.gpkg) files in the <code>inst/extdata</code> folder</li>
<li>Caching very large (&gt;100 MB) data sets as geopackage files in a cache folder selected using the <code><a href="https://rappdirs.r-lib.org/reference/user_cache_dir.html">rappdirs::user_cache_dir()</a></code> function</li>
<li>Offering other functions to download spatial data from remote sources including city and state ArcGIS servers, the state open data portal, and on Open Street Map</li>
</ul>
<p>The external and cached data sources are never fully loaded into active memory. Instead, mapbaltimore uses the <code>wkt_filter</code> parameter for the <code><a href="https://r-spatial.github.io/sf/reference/st_read.html">sf::st_read()</a></code> function as described in <a href="https://jayrobwilliams.com/posts/2020/09/spatial-sql">this post on Working with Large Spatial Data in R</a> by Rob Williams to import only the data you need. Continue reading to explore how these three different data access options work within the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mapbaltimore</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="fu"><a href="../reference/set_map_theme.html">set_map_theme</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="external-data-sources" class="section level2">
<h2 class="hasAnchor">
<a href="#external-data-sources" class="anchor"></a>External data sources</h2>
<p>Currently, the external data sources include:</p>
<ul>
<li>Trees (also available on the <a href="https://baltimore.maps.arcgis.com/apps/webappviewer/index.html?id=d2cfbbe9a24b4d988de127852e6c26c8%20">Tree Baltimore website</a>)</li>
<li>Unimproved property (a subset of the cached real property data)</li>
<li>Vegetated areas</li>
</ul>
<p>This data can be accessed using the extdata parameter of the <code>get_area_data</code> function as the following examples illustrate.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Get trees in the Oliver neighborhood</span>
<span class="va">oliver_trees</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_area.html">get_area</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"neighborhood"</span>, area_name <span class="op">=</span> <span class="st">"Oliver"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
<span class="fu"><a href="../reference/get_area_data.html">get_area_data</a></span><span class="op">(</span>extdata <span class="op">=</span> <span class="st">"trees"</span><span class="op">)</span>
<span class="co">#&gt; Reading layer `trees' from data source `/Library/Frameworks/R.framework/Versions/4.0/Resources/library/mapbaltimore/extdata/trees.gpkg' using driver `GPKG'</span>
<span class="co">#&gt; Simple feature collection with 1068 features and 15 fields</span>
<span class="co">#&gt; geometry type:  POINT</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 434147.3 ymin: 181822.2 xmax: 434972.5 ymax: 182736.2</span>
<span class="co">#&gt; projected CRS:  NAD83(HARN) / Maryland</span>

<span class="co"># Show the top 6 species pluralis (spp) by number</span>
<span class="va">oliver_trees</span> <span class="op">%&gt;%</span> 
  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">spp</span>, sort <span class="op">=</span> <span class="cn">TRUE</span>, name <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">spp</th>
<th align="right">count</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Acer rubrum</td>
<td align="right">211</td>
</tr>
<tr class="even">
<td align="left">Quercus phellos</td>
<td align="right">101</td>
</tr>
<tr class="odd">
<td align="left">Prunus spp.</td>
<td align="right">69</td>
</tr>
<tr class="even">
<td align="left">Zelkova serrata</td>
<td align="right">59</td>
</tr>
<tr class="odd">
<td align="left">Platanus x acerifolia</td>
<td align="right">49</td>
</tr>
<tr class="even">
<td align="left">Ulmus x</td>
<td align="right">46</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Plot tree locations sized by diameter at breast height (dbh)</span>
<span class="va">oliver_trees</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">dbh</span>, color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="extdata_cachedata_files/figure-html/trees-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">druidhill</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_area.html">get_area</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"neighborhood"</span>, area_name <span class="op">=</span> <span class="st">"Druid Hill Park"</span><span class="op">)</span>

<span class="fu"><a href="../reference/get_area_data.html">get_area_data</a></span><span class="op">(</span>area <span class="op">=</span> <span class="va">druidhill</span>, extdata <span class="op">=</span> <span class="st">"vegetated_area"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkgreen"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/layer_area_mask.html">layer_area_mask</a></span><span class="op">(</span>area <span class="op">=</span> <span class="va">druidhill</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="cn">NA</span>, dist <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; Reading layer `vegetated_area' from data source `/Library/Frameworks/R.framework/Versions/4.0/Resources/library/mapbaltimore/extdata/vegetated_area.gpkg' using driver `GPKG'</span>
<span class="co">#&gt; Simple feature collection with 182 features and 2 fields</span>
<span class="co">#&gt; geometry type:  MULTIPOLYGON</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 429440.2 ymin: 182795.9 xmax: 432629.7 ymax: 185069.4</span>
<span class="co">#&gt; projected CRS:  NAD83(HARN) / Maryland</span></code></pre></div>
<p><img src="extdata_cachedata_files/figure-html/vegetated_area-1.png" width="700"></p>
<p>Incomplete documentation for these external datasets is included in the <code>extdata.R</code> file but this documentation not exported so cannot be accessed directly via the help menu.</p>
</div>
<div id="cached-data-sources" class="section level2">
<h2 class="hasAnchor">
<a href="#cached-data-sources" class="anchor"></a>Cached data sources</h2>
<p>After you first install mapbaltimore, you want to run <code>cache_mapbaltimore_data</code> with no parameters to access real property data, edge of pavement data, and streets outside Baltimore City. Customizing the cache location or the coordinate reference system is possible but it is not recommended. Downloading all of this data takes a <em>very</em> long time and takes up around around 700 MB when all three files are cached.</p>
<p>To update the cached files, use the <code>overwrite = TRUE</code> parameter. I recommend overwriting individual data sets rather than all cached data sets as the <code>real_property</code> data set is the only one that should require occasional updates.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># cache_mapbaltimore_data()</span>
<span class="co"># cache_real_property(overwrite = TRUE)</span></code></pre></div>
<p>After the data is cached, it can always be accessed using the <code>cache_data</code> parameter of <code><a href="../reference/get_area_data.html">get_area_data()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_area.html">get_area</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"neighborhood"</span>, area_name <span class="op">=</span> <span class="st">"Federal Hill"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/get_area_data.html">get_area_data</a></span><span class="op">(</span>cachedata <span class="op">=</span> <span class="st">"edge_of_pavement"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span>
<span class="co">#&gt; Reading layer `edge_of_pavement' from data source `/Users/elipousson/Library/Caches/mapbaltimore/edge_of_pavement.gpkg' using driver `GPKG'</span>
<span class="co">#&gt; Simple feature collection with 481 features and 2 fields</span>
<span class="co">#&gt; geometry type:  MULTIPOLYGON</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 433023.3 ymin: 178513.8 xmax: 434164.2 ymax: 179718.8</span>
<span class="co">#&gt; projected CRS:  NAD83(HARN) / Maryland</span></code></pre></div>
<p><img src="extdata_cachedata_files/figure-html/edge_of_pavement-1.png" width="700"></p>
<p>The <code><a href="../reference/map_area_property.html">map_area_property()</a></code> function requires the cached real property data and will not work without it.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_area.html">get_area</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"neighborhood"</span>, area_name <span class="op">=</span> <span class="st">"Morgan Park"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
<span class="fu"><a href="../reference/map_area_property.html">map_area_property</a></span><span class="op">(</span>property <span class="op">=</span> <span class="st">"principal residence"</span>,
                  show_mask <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Reading layer `real_property' from data source `/Users/elipousson/Library/Caches/mapbaltimore/real_property.gpkg' using driver `GPKG'</span>
<span class="co">#&gt; Simple feature collection with 317 features and 180 fields (with 1 geometry empty)</span>
<span class="co">#&gt; geometry type:  MULTIPOLYGON</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 435612.8 ymin: 185829.8 xmax: 436827.7 ymax: 187464.3</span>
<span class="co">#&gt; projected CRS:  NAD83(HARN) / Maryland</span></code></pre></div>
<p><img src="extdata_cachedata_files/figure-html/real_property-1.png" width="700"></p>
<p>Other functions such as <code><a href="../reference/layer_area_streets.html">layer_area_streets()</a></code> use an optional parameter to determine whether to use the city streets data or the cached <code>baltimore_msa_streets</code> data. Maps that show area near or crossing the city boundaries show much better when the full data can be used.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">second_district</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_area.html">get_area</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"congressional district"</span>, area_name <span class="op">=</span> <span class="st">"2nd District"</span><span class="op">)</span>

<span class="va">district_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">second_district</span>, fill <span class="op">=</span> <span class="st">"springgreen"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>

<span class="co"># If msa = FALSE, layer_area_streets uses the city streets data</span>
<span class="va">district_map</span> <span class="op">+</span> <span class="fu"><a href="../reference/layer_area_streets.html">layer_area_streets</a></span><span class="op">(</span>area <span class="op">=</span> <span class="va">second_district</span>, sha_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"INT"</span>, <span class="st">"FWY"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="extdata_cachedata_files/figure-html/streets_msa-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">  
<span class="co"># If msa = TRUE, layer_area_streets uses the cached baltimore_msa_streets data</span>
<span class="va">district_map</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/layer_area_streets.html">layer_area_streets</a></span><span class="op">(</span>area <span class="op">=</span> <span class="va">second_district</span>, sha_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"INT"</span>, <span class="st">"FWY"</span><span class="op">)</span>, msa <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Reading layer `baltimore_msa_streets' from data source `/Users/elipousson/Library/Caches/mapbaltimore/baltimore_msa_streets.gpkg' using driver `GPKG'</span>
<span class="co">#&gt; Simple feature collection with 26196 features and 22 fields (with 3 geometries empty)</span>
<span class="co">#&gt; geometry type:  MULTILINESTRING</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 400446.3 ymin: 146306.1 xmax: 488109.9 ymax: 228126.6</span>
<span class="co">#&gt; projected CRS:  NAD83(HARN) / Maryland</span></code></pre></div>
<p><img src="extdata_cachedata_files/figure-html/streets_msa-2.png" width="700"></p>
</div>
<div id="remote-data-sources" class="section level2">
<h2 class="hasAnchor">
<a href="#remote-data-sources" class="anchor"></a>Remote data sources</h2>
<p>Both the externally stored and cached data could be access remotely whenever needed but the large file size makes keeping a local version much faster. If the data is more frequently updated (or less frequently used), downloading the data whenever it is needed is likely preferable.</p>
<p>For example, <code><a href="../reference/get_area_esri_data.html">get_area_esri_data()</a></code> can take a <code>url</code> for an ArcGIS MapServer or FeatureServer or take a <code>type</code> parameter that corresponds to a MapServer or FeatureServer url from Open Baltimore, Maryland iMap, or the <a href="https://mdfoodsystemmap.org/">Maryland Food System Map</a>. The list of urls is currently internal system data but will be opened to package users in the future.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">north</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_area.html">get_area</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"planning district"</span>, area_id <span class="op">=</span> <span class="st">"North"</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/layer_area_streets.html">layer_area_streets</a></span><span class="op">(</span>area <span class="op">=</span> <span class="va">north</span>, sha_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PART"</span>, <span class="st">"MART"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/get_area_esri_data.html">get_area_esri_data</a></span><span class="op">(</span>area <span class="op">=</span> <span class="va">north</span>, type <span class="op">=</span> <span class="st">"red light cameras"</span><span class="op">)</span>,
          fill <span class="op">=</span> <span class="st">"red"</span>, shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">4</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/get_area_esri_data.html">get_area_esri_data</a></span><span class="op">(</span>area <span class="op">=</span> <span class="va">north</span>, type <span class="op">=</span> <span class="st">"fixed speed cameras"</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"yellow"</span>, shape <span class="op">=</span> <span class="fl">25</span>, size <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>
<span class="co">#&gt; [1] "Feature Layer"</span>
<span class="co">#&gt; [1] "esriGeometryPoint"</span>
<span class="co">#&gt; [1] "Coordinate Reference System: 3857"</span>
<span class="co">#&gt; [1] "Feature Layer"</span>
<span class="co">#&gt; [1] "esriGeometryPoint"</span>
<span class="co">#&gt; [1] "Coordinate Reference System: 3857"</span></code></pre></div>
<p><img src="extdata_cachedata_files/figure-html/esri_data-1.png" width="700"></p>
<p><code>get_area_osm_data</code> wraps the <code>osmdata</code> package largely to simplify the experience of using the package. Open Street Map is particularly useful for accessing data that may not be available from other non-commercial sources, such as the location of bowling alleys in Baltimore City and County. Be aware that the <a href="https://wiki.osmfoundation.org/wiki/Licence/Licence_and_Legal_FAQ#What_is_the_licence.2C_how_can_I_use_it.3F">Open Street Map license</a> requires credit any time you use OSM data.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">baltimore_county</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">baltimore_msa_counties</span>, <span class="va">namelsad</span> <span class="op">==</span> <span class="st">"Baltimore County"</span><span class="op">)</span>

<span class="va">baltimore_county</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/get_area_osm_data.html">get_area_osm_data</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"leisure"</span>,
                value <span class="op">=</span> <span class="st">"bowling_alley"</span>,
                trim <span class="op">=</span> <span class="cn">TRUE</span>,
                crs <span class="op">=</span> <span class="fl">2804</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">baltimore_msa_counties</span>, color <span class="op">=</span> <span class="st">"grey30"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_label_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">name</span>, label <span class="op">=</span> <span class="va">name</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, force <span class="op">=</span> <span class="fl">10</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="../reference/set_map_limits.html">set_map_limits</a></span><span class="op">(</span>area <span class="op">=</span> <span class="va">baltimore_county</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Data courtesy Open Street Map."</span><span class="op">)</span>
<span class="co">#&gt; Open Street Map data is available under the Open Database Licence which requires attribution. See https://www.openstreetmap.org/copyright for more information.</span></code></pre></div>
<p><img src="extdata_cachedata_files/figure-html/area_osm_data-1.png" width="700"></p>
<p>Lastly, <code><a href="../reference/get_maryland_open_resource.html">get_maryland_open_resource()</a></code> can be used to access data from the Socrata-based Maryland Open Data portal by wrapping the <code><a href="https://rdrr.io/pkg/RSocrata/man/read.socrata.html">RSocrata::read.socrata()</a></code> function. The <code>get_area_crashes</code> function calls <code><a href="../reference/get_maryland_open_resource.html">get_maryland_open_resource()</a></code> using the appropriate identifier for the table on vehicular crashes.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">charles_north</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_area.html">get_area</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"neighborhood"</span>, area_name <span class="op">=</span> <span class="st">"Charles North"</span><span class="op">)</span>

<span class="va">charles_north</span> <span class="op">%&gt;%</span> 
<span class="fu"><a href="../reference/get_area_crashes.html">get_area_crashes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="cn">TRUE</span>, trim <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/layer_area_streets.html">layer_area_streets</a></span><span class="op">(</span>area <span class="op">=</span> <span class="va">charles_north</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"orangered"</span>, alpha <span class="op">=</span> <span class="fl">0.75</span>, size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">charles_north</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span>, size <span class="op">=</span> <span class="fl">2</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></code></pre></div>
<p><img src="extdata_cachedata_files/figure-html/area_crashes-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Eli Pousson.</p>
</div>

<div class="pkgdown">
  <p>Made with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1, using <a href="https://preferably.amirmasoudabdol.name/?source=footer">preferably</a> template.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
